
--Ignore if database already exists
CREATE DATABASE foodbase;
USE foodbase;
--end of comment

CREATE TABLE user (
	ID Int NOT NULL AUTO_INCREMENT,
	email VARCHAR(45),
	password VARCHAR(500),
	username VARCHAR(45),
	area VARCHAR(45),
	role Int DEFAULT 1,
	PRIMARY KEY (ID)
);

CREATE TABLE food_fact (
	ID Int NOT NULL AUTO_INCREMENT,
	name VARCHAR(45),
	display_name VARCHAR(45),
	type Int,
	PRIMARY KEY (ID)
);

CREATE TABLE post (
	ID Int NOT NULL AUTO_INCREMENT,
	filename VARCHAR(45),
	description VARCHAR(1000) DEFAULT "",
	time_stamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP(),
	name VARCHAR(45),
	owner_ID Int,
	area VARCHAR(45),
	PRIMARY KEY (ID),
	FOREIGN KEY (owner_ID) REFERENCES user(ID)
);

CREATE TABLE post_to_food_fact (
	ID Int NOT NULL AUTO_INCREMENT,
	post_ID Int,
	food_fact_ID Int,
	PRIMARY KEY (ID),
	FOREIGN KEY (post_ID) REFERENCES post(ID),
	FOREIGN KEY (food_fact_ID) REFERENCES food_fact(ID)
);

CREATE TABLE user_preferences (
	ID Int NOT NULL AUTO_INCREMENT,
	user_ID Int,
	food_fact_ID Int,
	PRIMARY KEY (ID),
	FOREIGN KEY (user_ID) REFERENCES user(ID),
	FOREIGN KEY (food_fact_ID) REFERENCES food_fact(ID)
);

INSERT INTO food_fact(name,display_name,type)
VALUES("gluten","Gluten-free",0),
("fish","Fish-free",0),
("egg","Egg-free",0),
("lactose","Lactose-free",0),
("milk","Milk-free",0),
("soybean","Soybean-free",0),
("nut","Nut-free",0),
("sesame_seed","Sesame seed-free",0),
("vegan","Vegan",1),
("sugar","Sugar free",1),
("meat","Meat free",1),
("low_fat","Low fat",1);

--VET (valid end time) not yet implemented
--description DEFAULT is set to empty string
--user roles 0 = admin, 1 = registered user

--flagging not yet implemented
--rating not yet implemented

SHOW TABLES;
DESCRIBE user;
DESCRIBE food_fact;
DESCRIBE post;
DESCRIBE post_to_food_fact;
DESCRIBE user_preferences;
